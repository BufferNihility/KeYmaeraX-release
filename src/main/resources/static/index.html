<html>
<head>
<link rel="stylesheet" href="/static/css/jquery.contextmenu.css">
<style>
  #prover {
    border: 2px solid;
    border-radius: 25px;
    background-color:rgba(0,0,0,0.1);
    height: 90%;
    width: 100%;
    text-align: center;
    vertical-align: center;
    font-size: 20px;
  }
  #footer {
    text-align: center;
    height: 5%;
    width: 100%;
  }
  #welcome {
    
    text-align: center;
    font-size: 32px;
    width: 100%;
    height: 5%;
  }
</style>
<script src="/static/js/jquery.js" type="text/javascript"></script>
<script src="/static/js/jquery.contextmenu.js"></script>
<script src="/static/js/api_client.js" type="text/javascript"></script>
<script src="/static/js/expression.js" type="text/javascript"></script>
<script src="/static/js/event_handler.js" type="text/javascript"></script>
<script>
  var client = new HydraClient();

  //Handles an event from the file chooser.
  function handleChooserEvent(evt) {
    evt.stopPropagation();
    evt.preventDefault();

    var files = evt.dataTransfer.files;
    var file = files[0];
    loadFile(file);
  }

  //Loads a window.File object using the FileReader.
  function loadFile(file) {
    var fr = new FileReader();
    fr.onerror = function(e) { alert("Could not even open your file: " + e.getMessage()); }

    fr.onload = function(e) {
      client.startNewProblem(e.target.result);
    }

    fr.readAsText(file);
  }

  //Initialize the file selector and main event loop when the page is loaded.
  window.onload = function() {
    if(!(window.File && window.FileReader && window.FileList && window.Blob)) {
      alert("The KeYmaera4 web front-end requires the HTML 5 file API. " +
            "It appears your browser does not support this API ." +
            "Please update to the latest version of a standards-compliant browser.");
    }

    //Add an event listener for the file box.
    var drop_zone = document.getElementById('drop_zone');
    drop_zone.addEventListener('dragover', function(evt) {
        evt.stopPropagation();
        evt.preventDefault();
        evt.dataTransfer.dropEffect = 'copy';
      }, false);
    drop_zone.addEventListener('drop', function(evt) {
        evt.stopPropagation();
        evt.preventDefault();
        var files = evt.dataTransfer.files;
        var file = files[0];
        loadFile(file);
        }, false);
    files.addEventListener('change', function(evt) {
        var files = evt.target.files;
        var file = files[0];
        loadFile(file);
        }, false);
    //Create main event loop. Ugh we should be doing something better.
    setInterval(function() { client.getUpdates(); }, 500);
  }
</script>
</head>
<body>
<div class="welcome" id="welcome">
  KeYmaera4
</div>
<div class="prover" id="prover">
  <span id="provercontents">
    <div class="drop_zone" id="drop_zone">
      Drag and Drop a .key into the grey area to begin.
      <br/>
      <br/>
      <input type="file" id="files" name="files[]" multiple />
    </div>
  </span>
</div>
<span class="footer">
  <center>
    <span id="status" style="background-color: #555500; color: #FFFFFF">Disconnected</span>
  </center>
</span>
</body>
</html>

