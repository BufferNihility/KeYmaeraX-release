Formula is rather incomplete, but the actual definition is quite complicated.

I'm also not sure if this requires the correct things.
